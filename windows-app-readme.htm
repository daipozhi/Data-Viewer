<HTML>
	<HEAD>
		<TITLE>管理信息系统工具 BoWo Windows版
		</TITLE>
		<META http-equiv=Content-Type content="text/html; charset=gb_2312-80">
		<META content="MSHTML 6.00.2800.1561" name=GENERATOR>
	</HEAD>
<BODY bgColor=#ffffff>
<STRONG>
<pre>
Windows 系统 C++ 管理信息系统(MIS)生成工具 BoWo Windows版介绍
</pre>
</STRONG>
<pre>

     用C++在Windows下实现，可以输入，查询，打印数据库数据，使用文本文件生成图形窗口用户界面，包括各种窗口控件，

用DBF格式文件保存数据，有大量例子，支持数据库记录之间的关联，可以按照文本模板打印数据库数据，支持多用户同时操

作数据库。

     用户可以下载软件包，在任意目录下展开，运行主程序vc_bowo2.exe。

     在菜单中选择 表格-->运行表格-->选择 'bowo_main.sc4'，表格的设计方法请参考下文。

</pre>
<P>
<STRONG>
<pre>
Windows 系统 C++ 管理信息系统(MIS)生成工具 BoWo Windows版设计指南
</pre>
</STRONG>
</P>
<pre>
1，设计数据库结构

编写如下的文本文件：

date f1 c 8
dept f3 c 40
topc f5 c 40
cont f4 m 8

每行各字段分为：
字段说明，字段名，字段类型（C 字符型，N 数字型，M 文字文件，B 位图文件），字段长度（M 型定为8，B 型定为253）等四部分。
设计好后按文本文件存盘，扩展名为*.TB3，当用BOWO打开这个文件时，将提示建立相应的DBF数据库文件。

</pre>
<pre>
2，窗口界面设计

    首先用制表符（+，-，│，┌，┐，├，┤，┬，┴，┼，│，─）画出表格形式，在字段处，使用字段替代符号，&?是内存字段，
&?f1是名为f1的内存字段。&@是按钮，&@a 是名为A的按钮。&(是单选项，&(1是名为1的单选项，&[是复选项，&[1是名为1的复选项，
&:是数据库符号，&:t2表示若T2是数据库名，按文字顺序，后面的字段为T2数据库的字段，若T2是字段，表示名为T2的数据库字段。

例如可以按照如下设计窗口文件：

    ┌────────────────┐
    │查询条件                        │
    ├─────┬──────────┤
    │日期      │&?f1                │
    ├─────┼──────────┤
    │部门      │&?f3                │
    ├─────┼──────────┤
    │标题      │&?f5                │
    ├─────┴──────────┤
    │  &@a 确定          &@b 取消    │
    └────────────────┘

</PRE>

以上窗口文件将显示如下：<br>
<img src=win1.jpg>

<pre>
或者你可以这样设计窗口文件

    ┌────────────────┐
    │查询条件                        │
    ├────────────────┤
    │                                │
    │日期   {&?f1                }   │
    │                                │
    │部门   {&?f3                }   │
    │                                │
    │标题   {&?f5                }   │
    │                                │
    ├────────────────┤
    │  &@a( 确定 )     &@b( 取消 )   │
    └────────────────┘

</PRE>
以上窗口文件将显示如下：<br>
<img src=win2.jpg>
<p>
<pre>
带有数据库的窗口文件可以按照如下方法设计


&usetable=dc_zc,stru=dc_zc,basetype=xbase,backup=1（使用数据库文件DC_ZC.DBF，结构为DC_ZC.TB3）
&findfile=dcf_zc（查找数据库时的窗口文件为DCF_ZC.SC4）
&enddefine（定义结束）
┌──────────────────────────────────────┐
│ 文件一                                                                     │
├─────┬──────────┬────────────────┬────┤
│日期      │部门                │标题                            │内容    │
├─────┼──────────┼────────────────┼────┤
│&:f1      │&:f3                │&:f5                            │&:f4    │（各字段，第一行）
│&:f1      │&:f3                │&:f5                            │&:f4    │（各字段，第二行）
│&:f1      │&:f3                │&:f5                            │&:f4    │（各字段，第三行）
│&:f1      │&:f3                │&:f5                            │&:f4    │（。。。）
│&:f1      │&:f3                │&:f5                            │&:f4    │（。。。）
│&:f1      │&:f3                │&:f5                            │&:f4    │（。。。）
│&:f1      │&:f3                │&:f5                            │&:f4    │
│&:f1      │&:f3                │&:f5                            │&:f4    │
│&:f1      │&:f3                │&:f5                            │&:f4    │
│&:f1      │&:f3                │&:f5                            │&:f4    │
│&:f1      │&:f3                │&:f5                            │&:f4    │
│&:f1      │&:f3                │&:f5                            │&:f4    │
│&:f1      │&:f3                │&:f5                            │&:f4    │
│&:f1      │&:f3                │&:f5                            │&:f4    │
│&:f1      │&:f3                │&:f5                            │&:f4    │
│&:f1      │&:f3                │&:f5                            │&:f4    │
├─────┴──────────┴────────────────┴────┤
│  &@i(查询条件) &@j(开始查询) &@k(结束查询) &@c(上页) &@b(下页) &@a(退出)   │（按钮）
└──────────────────────────────────────┘

</PRE>
<P>以上是文本文件，扩展名为*.sc4，将显示如下窗口：</P>
<img src=win3.jpg >

<pre>
带有数据库的窗口文件也可以按照如下方法设计

&usetable=dc_hy,stru=dc_hy,basetype=xbase,backup=1
&findfile=dcf_hyc
&enddefine
  ┌──────────────────────────────┐
  │会员状态                                                    │
  ├──────────────────────────────┤
  │                                                            │
  │名    称 {&:f1                        } 代    码 {&:f12    }│
  │                                                            │
  │部    门 {&:f2                                             }│
  │                                                            │
  │地    址 {&:f3                        } 姓    名 {&:f4     }│
  │                                                            │
  │主    管 {&:f5                        } 电话号码 {&:f6     }│
  │                                                            │
  │注册时间 {&:f7         } 邮编 {&:f8   } 公司状态 {&:f9     }│
  │                                                            │
  │状    态 {&:f10                       } 费    用 {&:f11    }│
  │                                                            │
  ├──────────────────────────────┤
  │    &@i(查询条件)    &@j(开始查询)    &@k(结束查询)         │
  │                                                            │
  │    &@c(  上页  )    &@b(  下页  )    &@a(  退出  )         │
  └──────────────────────────────┘
&endscreen

</PRE>
<P>将显示如下窗口：</P>
<img src=win5.jpg >


<pre>
3，按钮的定义

如果窗口文件中定义了按钮，按钮的作用定义如下：

@a button="[]" com=exit （编号a的按纽是退出）
@c button="[]" com=page_up（编号c的按纽是向上翻页）
@b button="[]" com=page_down（编号b的按纽是向下翻页）
@d button="[]" com=insert_rec（插入记录）
@e button="[]" com=cancel（中断退出）
@f button="[]" com=delete_rec（删除记录）
@g button="[]" com=rollback（数据库数据滚回）
@h button="[]" com=commit（数据库数据提交）
@i button="[]" com=findcondition（输入查找条件）
@j button="[]" com=beginfind（开始查找）
@k button="[]" com=endfind（停止查找）

或

@a button="[]" com=get_tab("\to_netease6\bowo2app\app5\dc_wy1.sc4")（打开目录\to_netease6\bowo2app\app5\下的dc_wy1.sc4窗口文件）
@b button="[]" com=get_tab("\to_netease6\bowo2app\app5\dc_wy2.sc4")（打开目录\to_netease6\bowo2app\app5\下的dc_wy2.sc4窗口文件）
@c button="[]" com=get_tab("\to_netease6\bowo2app\app5\dc_wy3.sc4")（打开目录\to_netease6\bowo2app\app5\下的dc_wy3.sc4窗口文件）

以上数据以文本文件保存在与窗口文件同名的*.TB1中。

4,单选钮的设置

在窗口文件中如下设置

┌户型  ───────────┐┌价格  ───────────────┐
│&(1 4*2   &(1 2*2  &(1 4*1  ││&(2 1000/m2 以下   &(2 3001-4000/m2 │
│&(1 2*1   &(1 3*2  &(1 1*1  ││&(2 1001-2000/m2   &(2 4001/m2 以上 │
│&(1 3*1   &(1 全部          ││&(2 2001-3000/m2   &(2 全部         │
└──────────────┘└──────────────────┘

&(1 表示第一组的1个单选钮，&(2 表示第二组的1个单选钮，同时在与窗口文件同名的*.tb5文件中定义如下

(1 fdca1 1
(2 fdca2 1
(3 fdca3 1
(4 fdca4 1
(5 fdca5 1
(6 fdca6 1
(7 fdca7 1

fdca1等是变量名，‘1’是缺剩设置

5,复选钮的设置

在窗口文件中如下设置

┌区域  ───────────────┐
│&[1 上城区   &[6  萧山  &[10 临安   │
│&[2 下城区   &[7  余杭  &[11 桐栌   │
│&[3 西湖区   &[8  富阳  &[12 淳安   │
│&[4 江干区   &[9  建德  &[13 其他   │
│&[5 拱墅区                          │
└──────────────────┘

&[1 表示第1个复选钮，&[2 表示第2个复选钮，同时在与窗口文件同名的*.tb6文件中定义如下

[1 fdcb1 0
[2 fdcb2 0
[3 fdcb3 0
[4 fdcb4 0
[5 fdcb5 0
[6 fdcb6 0
[7 fdcb7 0
[8 fdcb8 0
[9 fdcb9 0
[10 fdcb10 0
[11 fdcb11 0
[12 fdcb12 0
[13 fdcb13 0

fdcb1等是变量名，‘0’表示设置为不选

把多种按纽组合在一起，可以设计为如下的窗口文件：

┌────────────────────────────────────┐
│私人住宅查询                                                            │
│┌户型  ───────────┐┌价格  ───────────────┐│
││&(1 4*2   &(1 2*2   &(1 4*1 ││&(2 1000/m2 以下   &(2 3001-4000/m2 ││
││&(1 2*1   &(1 3*2   &(1 1*1 ││&(2 1001-2000/m2   &(2 4001/m2 以上 ││
││&(1 3*1   &(1 全部          ││&(2 2001-3000/m2   &(2 全部         ││
│└──────────────┘└──────────────────┘│
│┌期房还是现房  ───────┐┌区域  ───────────────┐│
││&(3 现房  &(3 期房  &(3 全部││&[1 上城区   &[6  萧山  &[10 临安   ││
│└──────────────┘│&[2 下城区   &[7  余杭  &[11 桐栌   ││
│┌出租还是出售  ───────┐│&[3 西湖区   &[8  富阳  &[12 淳安   ││
││&(4 出租  &(4 出售  &(4 全部││&[4 江干区   &[9  建德  &[13 其他   ││
│└──────────────┘│&[5 拱墅区                          ││
│┌层次  ───────────┐└──────────────────┘│
││&(5 多层  &(5 高层  &(5 低层│┌楼层  ───────────────┐│
││&(5 全部                    ││&(7 底层     &(7  顶层  &(7  其他   ││
│└──────────────┘│&(7 全部                            ││
│┌地段  ───────────┐└──────────────────┘│
││&(6 1类   &(6 2类           │                                        │
││&(6 3类   &(6 4类   &(6 全部│ &@a( 确定 ) &@b( 取消 ) &@c( 其他 )    │
│└──────────────┘                                        │
└────────────────────────────────────┘
</pre>
<br>
以上窗口文件将显示如下：
<br>
<img src=win4.jpg>
<P>
<pre>
6,内存变量的设置

在窗口文件中如下设置

    ┌────────────────┐
    │查询条件                        │
    ├─────┬──────────┤
    │日期      │&?f1                │
    ├─────┼──────────┤
    │部门      │&?f3                │
    ├─────┼──────────┤
    │标题      │&?f5                │
    ├─────┴──────────┤
    │  &@a 确定          &@b 取消    │
    └────────────────┘

&?f1 表示对应数据库文件f1字段的内存变量,同时在与窗口文件同名的*.tb2文件中定义如下：

?f1 e c 40 0
?f2 e c 3  0
?f3 e c 40 0
?f4 e c 4  0
?f5 e c 70 0
?f6 e c 70 0
?f7 e c 70 0
?f8 e c 20 0

f1等是变量名,'e'表示可修改，'c'表示是字符型，40是内存变量长度， '0'是小数位

本窗口是查找窗口，用鼠标点击FindOpt（查询条件）时弹出此窗口，再按StartFind（开始查找）按钮，程序将根据内存变量查找
匹配的数据库记录。

7，数据库记录连接的设计

首先设计包含多个数据库文件的窗口，例如如下

&usetable=r1,stru=r1,basetype=xbase,backup=1
&usetable=r2,stru=r2,basetype=xbase,backup=1
&usetable=r3,stru=r3,basetype=xbase,backup=1
┌─────────────────────────────┐
│&:r1                    课程表          &*time            │
├───┬─────┬───────────────────┤
│姓名  │学号      │家庭电话号码                          │
├───┼─────┼───────────────────┤
│&:f2  │&:f1      │&:f3                                  │
├───┴─────┴───────────────────┤
│         &@b(下页)    &@c(上页)    &@a(退出)              │
├────┬─────┬─────────┬────────┤
│教    室│课 程编 号│ 课  程    名  称 │ 教  师  名  称 │
├────┼─────┼─────────┼────────┤
│&:r2.f3 │&:r3.f2   │&:r2.f2           │ &:r2.f4        │
│&:r2.f3 │&:r3.f2   │&:r2.f2           │ &:r2.f4        │
│&:r2.f3 │&:r3.f2   │&:r2.f2           │ &:r2.f4        │
│&:r2.f3 │&:r3.f2   │&:r2.f2           │ &:r2.f4        │
│&:r2.f3 │&:r3.f2   │&:r2.f2           │ &:r2.f4        │
│&:r2.f3 │&:r3.f2   │&:r2.f2           │ &:r2.f4        │
│&:r2.f3 │&:r3.f2   │&:r2.f2           │ &:r2.f4        │
│&:r2.f3 │&:r3.f2   │&:r2.f2           │ &:r2.f4        │
├────┴─────┴─────────┴────────┤
│三个数据库文件连接在一个窗口中 ,采用了多种类型的连接.     │
└─────────────────────────────┘

&:r2.f3 表示R2数据库的F3字段

然后编写与窗口文件同名的*.lnk文件，如下

r1&gt;r3 multi（R1数据库到R3数据库的多重连接连接）
  r1.f1=r3.f1（R1数据库的F1字段对应R3数据库的F1字段）
r3&gt;r2 single（R3数据库到R2数据库的一对一连接）
  r3.f2=r2.f1（R3数据库的F2字段对应R2数据库的F1字段）

其他文件的设置请参考目录下的文件

</pre>
<P>
<P>
<pre>
<STRONG>
同时欢迎使用 Linux 系统 C++ 管理信息系统(MIS)生成工具，在 Windows 下设计的窗口文件和保存
的数据可以原样的在 Linux 下使用，只是主程序改为 gcc_bowo.exe 。
</STRONG>
</pre>
<P>
<pre>
    如有问题请联系 daipozhi@sina.com
</pre>
<P>
</BODY>
</HTML>


